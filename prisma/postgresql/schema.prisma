generator postgresClient {
  provider = "prisma-client"
  output   = "./generated"
}

datasource postgres {
  provider = "postgresql"
  url      = env("POSTGRES_URL")
}

// API 调用详细日志
model ApiCallLog {
  requestId String @id @postgres.VarChar(26) // ULID，与 MySQL 中的 ApiCallRecord 关联

  // 请求信息
  requestPath String @postgres.VarChar(255) // 请求路径
  requestBody Json // 完整的请求体

  // 响应信息
  responseBody Json? // 非流式响应的完整响应体
  responseText String? @postgres.Text // 流式响应的文本内容
  statusCode   Int? // HTTP 状态码

  // 错误信息
  errorMessage String? @postgres.Text // 详细错误信息
  errorStack   String? @postgres.Text // 错误堆栈

  // 元数据
  headers  Json? // 请求头信息
  metadata Json? // 其他元数据（如上游信息、重试次数等）

  // 时间戳
  createdAt DateTime @default(now())

  @@index([createdAt]) // 用于按时间查询和清理
  @@map("api_call_logs")
}
